<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data Siswa - Guru Wali Bayu</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body { padding-bottom: 70px; } /* ruang untuk navbar bawah */
    #clock { font-weight: bold; color: #003f7f; }
    .logout-btn {
      background: #ffd84c;
      color: #002855;
      border: none;
      border-radius: 8px;
      padding: 6px 10px;
      cursor: pointer;
      font-weight: 600;
      transition: 0.3s;
    }
    .logout-btn:hover { background: #ffca2c; }

    .search-box {
      width: 90%; max-width: 500px; margin: 15px auto;
      display: block; padding: 8px 10px;
      border-radius: 8px; border: 1px solid #bbb;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }

    .card {
      width: 95%;
      max-width: 1100px;
      margin: 0 auto 80px auto;
      background: white;
      border-radius: 14px;
      padding: 15px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.05);
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      border-radius: 10px;
      overflow: hidden;
    }

    th, td {
      padding: 8px 10px;
      border-bottom: 1px solid #ddd;
      text-align: left;
      font-size: 14px;
    }

    th {
      background: #003f7f;
      color: white;
      position: sticky;
      top: 0;
      z-index: 2;
    }

    tr:hover { background: #f3f9ff; }
  </style>
</head>
<body class="light">

  <!-- ====== Topbar ====== -->
  <div class="topbar">
    <div class="top-left">
      <img src="assets/logo.png" alt="Logo" class="toplogo">
      <h2>Data Siswa</h2>
    </div>
    <div class="top-right" style="display:flex;align-items:center;gap:10px;">
      <span id="clock">00:00:00</span>
      <button class="logout-btn" onclick="logout()">Logout</button>
    </div>
  </div>

  <!-- ====== Konten Utama ====== -->
  <main class="menu-container">
    <input type="text" id="searchBox" class="search-box" placeholder="Cari nama atau NISN...">
    <div class="card">
      <table id="tabelSiswa">
        <thead>
          <tr>
            <th>No</th>
            <th>Nama</th>
            <th>JK</th>
            <th>NISN</th>
            <th>Tempat Lahir</th>
            <th>Tgl Lahir</th>
            <th>Agama</th>
            <th>Alamat</th>
            <th>Transportasi</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </main>

  <!-- ====== Navbar Bawah (tanpa ikon, gaya sama seperti notulen) ====== -->
  <div class="navbar">
    <a href="guru.html">Beranda</a>
    <a href="pengumuman.html">Pengumuman</a>
    <a href="curhatsiswa.html">Curhat</a>
    <a href="pembinaan.html">Pembinaan</a>
    <a href="masalahsiswa.html">Masalah</a>
  </div>

  <!-- ====== Script ====== -->
  <script>
    // Jam digital real-time
    function updateClock() {
      const now = new Date();
      const jam = String(now.getHours()).padStart(2, '0');
      const menit = String(now.getMinutes()).padStart(2, '0');
      const detik = String(now.getSeconds()).padStart(2, '0');
      document.getElementById("clock").textContent = `${jam}:${menit}:${detik}`;
    }
    setInterval(updateClock, 1000);
    updateClock();

    // Logout
    function logout() {
      if (confirm("Yakin ingin logout?")) {
        localStorage.removeItem('gw_ann_session_v3');
        window.location.href = 'index.html';
      }
    }

    // Ambil data siswa dari JSON
    async function loadSiswa() {
      try {
        const res = await fetch('data/siswa.json');
        const data = await res.json();
        const tbody = document.querySelector('#tabelSiswa tbody');
        tbody.innerHTML = '';

        data.forEach(siswa => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${siswa.no}</td>
            <td>${siswa.nama}</td>
            <td>${siswa.jk}</td>
            <td>${siswa.nisn}</td>
            <td>${siswa.tempat_lahir}</td>
            <td>${siswa.tgl_lahir}</td>
            <td>${siswa.agama}</td>
            <td>${siswa.alamat}</td>
            <td>${siswa.transportasi}</td>
          `;
          tbody.appendChild(tr);
        });

        // Fungsi pencarian
        const searchBox = document.getElementById('searchBox');
        searchBox.addEventListener('input', () => {
          const val = searchBox.value.toLowerCase();
          const rows = tbody.getElementsByTagName('tr');
          for (let r of rows) {
            const nama = r.cells[1].textContent.toLowerCase();
            const nisn = r.cells[3].textContent.toLowerCase();
            r.style.display = (nama.includes(val) || nisn.includes(val)) ? '' : 'none';
          }
        });
      } catch (err) {
        console.error('Gagal memuat data siswa:', err);
      }
    }

    loadSiswa();
  </script>

</body>
</html>
