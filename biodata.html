<script>
// URL RAW EXCEL dari GitHub kamu
const url = "https://raw.githubusercontent.com/yanuar-moga/guruwali/main/assets/data.xlsx";

// Ambil parameter NIS dari URL
const params = new URLSearchParams(window.location.search);
const nisParam = params.get("nis");

// Jika tidak ada parameter NIS
if (!nisParam) {
    document.getElementById("data").innerHTML = "<p>Parameter ?nis= tidak diberikan.</p>";
}

// Load Excel
fetch(url)
    .then(response => response.arrayBuffer())
    .then(buffer => {
        const workbook = XLSX.read(buffer, { type: "array" });
        const sheet = workbook.Sheets[workbook.SheetNames[0]];

        // Pakai defval agar kolom kosong tetap muncul
        const json = XLSX.utils.sheet_to_json(sheet, { defval: "" });

        console.log("Data Excel:", json); // DEBUG â€” cek nama kolom di console

        // Cari data siswa berdasarkan NIS
        const siswa = json.find(s => String(s.NIS).trim() === String(nisParam).trim());

        if (!siswa) {
            document.getElementById("data").innerHTML =
                `<p>Data dengan NIS <b>${nisParam}</b> tidak ditemukan di Excel.</p>`;
            return;
        }

        // Tampilkan foto
        document.getElementById("foto").src = `foto/${siswa.NIS}.jpg`;

        // Tampilkan data
        let html = "";
        for (let key in siswa) {
            html += `
            <p><span class="label">${key}: </span>${siswa[key]}</p>
            `;
        }
        document.getElementById("data").innerHTML = html;
    })
    .catch(err => {
        document.getElementById("data").innerHTML = "<p>Gagal memuat data Excel.</p>";
        console.error(err);
    });
</script>
