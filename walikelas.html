<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Dashboard Wali Kelas</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  margin: 0;
}
header {
  background: #2c7be5;
  color: white;
  padding: 15px;
  text-align: center;
}
.container {
  padding: 20px;
}
.card {
  background: white;
  padding: 15px;
  border-radius: 8px;
  margin-bottom: 20px;
}
h3 {
  margin-top: 0;
}
table {
  width: 100%;
  border-collapse: collapse;
}
th, td {
  border: 1px solid #ddd;
  padding: 8px;
  text-align: center;
}
th {
  background: #e9ecef;
}
</style>
</head>

<body>

<header>
  <h2>ðŸ“Š Dashboard Wali Kelas</h2>
  <p>Keadaan Kelas</p>
</header>

<div class="container">

<!-- KEADAAN KELAS -->
<div class="card">
<h3>Keadaan Kelas</h3>
<table>
<tr><th>Jenis</th><th>Jumlah</th></tr>
<tr><td>Laki-laki</td><td id="lk">0</td></tr>
<tr><td>Perempuan</td><td id="pr">0</td></tr>
<tr><th>Jumlah</th><th id="total">0</th></tr>
</table>
</div>

<!-- UMUR -->
<div class="card">
<h3>Jumlah Anak Berdasarkan Umur</h3>
<table>
<tr><th>Umur</th><th>Jumlah</th></tr>
<tr><td>11 Tahun</td><td id="u11">0</td></tr>
<tr><td>12 Tahun</td><td id="u12">0</td></tr>
<tr><td>13 Tahun</td><td id="u13">0</td></tr>
<tr><td>14 Tahun</td><td id="u14">0</td></tr>
<tr><td>15 Tahun</td><td id="u15">0</td></tr>
<tr><th>Jumlah Siswa</th><th id="total2">0</th></tr>
</table>
</div>

</div>

<script>
const sheetID = "1cSCzgeo-tD7QwDV-RUXTgb393LwyEwb9";
const sheetName = "DATA";
const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

fetch(url)
  .then(res => res.text())
  .then(text => {
    const json = JSON.parse(text.substr(47).slice(0, -2));
    const cols = json.table.cols.map(c => c.label);
    const rows = json.table.rows;

    const idxJK = cols.indexOf("Jenis Kelamin");
    const idxUmur = cols.indexOf("Umur");

    let lk = 0, pr = 0;
    let umur = {11:0,12:0,13:0,14:0,15:0};

    rows.forEach(r => {
      const jk = r.c[idxJK]?.v?.toString().toLowerCase();
      const u = parseInt(r.c[idxUmur]?.v);

      if (jk === "l" || jk === "laki-laki") lk++;
      if (jk === "p" || jk === "perempuan") pr++;

      if (umur[u] !== undefined) umur[u]++;
    });

    document.getElementById("lk").innerText = lk;
    document.getElementById("pr").innerText = pr;
    document.getElementById("total").innerText = lk + pr;

    document.getElementById("u11").innerText = umur[11];
    document.getElementById("u12").innerText = umur[12];
    document.getElementById("u13").innerText = umur[13];
    document.getElementById("u14").innerText = umur[14];
    document.getElementById("u15").innerText = umur[15];
    document.getElementById("total2").innerText = lk + pr;
  });
</script>

</body>
</html>
