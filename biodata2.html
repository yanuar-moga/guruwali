// tampilkan 1 kartu
function showCard(i) {
    index = i;
    const s = siswaData[i];
    if (!s) return;

    const fotoEl = document.getElementById("foto");

    // ---- NORMALISASI ABSEN ----
    let absen = String(s.ABSEN).trim();
    absen = parseInt(absen); // jadikan angka murni

    if (isNaN(absen)) {
        fotoEl.src = "https://via.placeholder.com/120x160?text=No+Foto";
    } else {

        const base = "https://raw.githubusercontent.com/yanuar-moga/guruwali/main/foto/";

        // coba beberapa kemungkinan ekstensi
        const kemungkinan = [
            `${base}${absen}.jpg`,
            `${base}${absen}.JPG`,
            `${base}${absen}.jpeg`,
            `${base}${absen}.png`
        ];

        function cobaLoad(idx = 0) {
            if (idx >= kemungkinan.length) {
                fotoEl.src = "https://via.placeholder.com/120x160?text=No+Foto";
                return;
            }
            const img = new Image();
            img.onload = () => (fotoEl.src = kemungkinan[idx]);
            img.onerror = () => cobaLoad(idx + 1);
            img.src = kemungkinan[idx];
        }

        cobaLoad();
    }

    // --------- TAMPILKAN DATA ---------
    let html = "";
    for (let key in s) {
        if (!LABEL_MAP[key]) continue;

        let label = LABEL_MAP[key];
        let value = excelDateToText(s[key]);

        html += `
            <p>
                <span class="label">${label}</span>:
                ${value}
            </p>
        `;
    }

    document.getElementById("data").innerHTML = html;
}
